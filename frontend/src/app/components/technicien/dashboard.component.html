<div class="dashboard-container" *ngIf="!isLoading">
    <div class="header" data-aos="fade-down">
        <h1>Tableau de Bord Technicien</h1>
        <p class="subtitle">Gérez vos tickets d'incidents et suivez leur progression.</p>
    </div>
    <div class="stats-grid">
        <div class="card stat-card total" data-aos="zoom-in" data-aos-delay="100">
            <div class="stat-icon"></div>
            <div class="info">
                <span class="value">{{ stats.totalTickets }}</span>
                <span class="label">Tickets Totaux</span>
            </div>
        </div>
        <div class="card stat-card ouvert" data-aos="zoom-in" data-aos-delay="200">
            <div class="stat-icon"></div>
            <div class="info">
                <span class="value">{{ stats.ouvert }}</span>
                <span class="label">Ouverts</span>
            </div>
        </div>
        <div class="card stat-card en-cours" data-aos="zoom-in" data-aos-delay="300">
            <div class="stat-icon"></div>
            <div class="info">
                <span class="value">{{ stats.enCours }}</span>
                <span class="label">En cours</span>
            </div>
        </div>
        <div class="card stat-card resolu" data-aos="zoom-in" data-aos-delay="400">
            <div class="stat-icon"></div>
            <div class="info">
                <span class="value">{{ stats.resolu }}</span>
                <span class="label">Résolus</span>
            </div>
        </div>
    </div>
    <div class="main-content">
        <div class="card content-card my-tickets-section" data-aos="fade-right">
            <div class="card-header">
                <h3>Mes Tickets En Cours</h3>
                <a routerLink="/tickets" class="view-all">Voir tous les tickets</a>
            </div>
            <div class="my-tickets-list">
                <div *ngFor="let ticket of stats.myTickets" class="ticket-item clickable"
                    [routerLink]="['/tickets', ticket.id]">
                    <div class="ticket-main">
                        <span class="ticket-title">{{ ticket.titre }}</span>
                        <span class="ticket-client">{{ ticket.client?.nom }} {{ ticket.client?.prenom }}</span>
                        <span class="ticket-project">{{ ticket.projet?.nom }}</span>
                    </div>
                    <div class="ticket-priority">
                        <span class="priority-badge" [ngClass]="ticket.priorite.toLowerCase()">
                            {{ ticket.priorite }}
                        </span>
                    </div>
                </div>
                <div *ngIf="stats.myTickets?.length === 0" class="empty-state">
                    Aucun ticket en cours. Vous pouvez prendre en charge les tickets ouverts !
                </div>
            </div>
        </div>
        <div class="card content-card latest-tickets-section" data-aos="fade-left">
            <div class="card-header">
                <h3>Derniers Tickets (Tous les clients)</h3>
                <a routerLink="/tickets/all" class="view-all">Voir tout</a>
            </div>
            <div class="latest-tickets-list">
                <div *ngFor="let ticket of stats.latestTickets" class="ticket-item clickable"
                    [routerLink]="['/tickets', ticket.id]">
                    <div class="ticket-main">
                        <span class="ticket-title">{{ ticket.titre }}</span>
                        <span class="ticket-info">
                            <span class="ticket-client">{{ ticket.client?.nom }}</span>
                            <span class="ticket-date">{{ ticket.dateCreation | date:'dd/MM/yyyy' }}</span>
                        </span>
                    </div>
                    <div class="ticket-status">
                        <span class="status-badge" [ngClass]="ticket.statut.toLowerCase()">
                            {{ ticket.statut }}
                        </span>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<div class="loading-overlay" *ngIf="isLoading">
    <div class="spinner"></div>
</div>
